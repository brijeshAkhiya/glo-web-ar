<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="main.css">
    <script type="module" src="./js/model-viewer.min.js"></script>
    <script nomodule src="./js/model-viewer-legacy.js"></script>
    <style>
      #error {
        background-color: #ffffffdd;
        border-radius: 16px;
        padding: 16px;
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate3d(-50%, -50%, 0);
        transition: opacity 0.3s;
      }

      #error.hide {
        opacity: 0;
        visibility: hidden;
        transition: visibility 2s, opacity 1s 1s;
      }
    </style>
  </head>
  <body>
    <pre id="rcorners2">
Instructions:
 - Please find a proper ground for the bulb for better results.
 - Please face your phone's camera parallel to the surface.
 - Please don't be in dark area before starting AR.
    </pre>
    <model-viewer style="display: none;" id="model-viewer" camera-controls autoplay ar shadow-intensity="1"
      ios-src="./GloBulb/Not Verified_Bulb_Option.FBX.usdz" alt="Bulb Verified">
      <button id="ar" slot="ar-button"
        style="width: 50px; height: 50px; background-color: white; border-radius: 4px; border: none; position: absolute; top: 16px; right: 16px; ">
        Activate AR
      </button>
    </model-viewer>
    <button id="ARButton" style="position: absolute; bottom: 20px; padding: 12px 6px; border: 1px solid rgb(255, 255, 255); border-radius: 4px; background: rgba(0, 0, 0, 0.1); color: rgb(255, 255, 255); font: 13px sans-serif; text-align: center; opacity: 0.5; outline: none; z-index: 999; cursor: pointer; left: calc(50% - 50px); width: 100px;">Start AR</button>
    <script>
      document.querySelector('button').style.display = "none";
      document.querySelector("model-viewer").addEventListener('ar-status', (event) => {
        if (event.detail.status === 'failed') {
          alert('failed');
          const error = document.querySelector("#error");
          error.classList.remove('hide');
          error.addEventListener('transitionend', (event) => {
            error.classList.add('hide');
          });
        }
      });
      document.querySelector('model-viewer').addEventListener('load', () => {
        if (document.querySelector('button')) {
          document.querySelector('button').click();
        }
      });
    </script>
  </body>

</html>