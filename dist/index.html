<!DOCTYPE html>
<html>

  <head>
    <title>AR Based Web App</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>
    <style>
      #error {
        background-color: #ffffffdd;
        border-radius: 16px;
        padding: 16px;
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate3d(-50%, -50%, 0);
        transition: opacity 0.3s;
      }
      #error.hide {
        opacity: 0;
        visibility: hidden;
        transition: visibility 2s, opacity 1s 1s;
      }
    </style>
  </head>

  <!-- <body onload="checkQrCode()">
    <script src="./js/ajax.js">
    </script>
  </body> -->

  <body>
    <model-viewer id="model-viewer" src="./Astronaut Model/Astronaut.gltf" ios-src="./Astronaut Model/Astronaut.usdz" ar ar-modes="scene-viewer webxr" ar-scale="auto" camera-controls alt="A 3D model of an astronaut">
      <div id="error" class="hide">AR is not supported on this device</div>
      <button id="ar" slot="ar-button"
        style="width: 50px; height: 50px; background-color: white; border-radius: 4px; border: none; position: absolute; top: 16px; right: 16px; ">
        ðŸ‘‹ Activate AR
      </button>
    </model-viewer>
    <script>
      document.querySelector('model-viewer').addEventListener('load', () => {
        console.log(document.querySelector('button'));
        console.log(navigator.xr)
      })
      document.querySelector("#model-viewer").addEventListener('ar-status', (event) => {
        if(event.detail.status === 'failed'){
          alert('failed');
          const error = document.querySelector("#error");
          error.classList.remove('hide');
          error.addEventListener('transitionend',(event) => {
            error.classList.add('hide');
          });
        }
      });
    </script>
    
    <script>
      // const model = document.querySelector('model-viewer');
      // const button = document.getElementById('ar');
      // button.addEventListener('click', () => {
      //   alert('clicked');
      // });
      // model.addEventListener('load', () => {
      //   button.click();
      // })
      // document.body.addEventListener('load', () => {
      //   if (document.querySelector('button')){
      //   alert('Ar supported');
      //   console.log(document.getElementById('ar'));
      //   document.getElementById('ar').click();
      // }
      // else {
      //   alert('AR not supported');
      //   console.log(document.getElementById('ar'));
      //   // document.getElementById('ar').click();
      // }
      // })
    </script>
  </body>

</html>